<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AGG for Rust — Interactive Demos</title>
  <link rel="stylesheet" href="./styles/main.css">
</head>
<body>
  <nav id="sidebar">
    <div class="sidebar-header">
      <h1 class="logo">AGG<span class="logo-accent">.rs</span></h1>
      <p class="tagline">Anti-Grain Geometry for Rust</p>
    </div>
    <div class="sidebar-actions">
      <button id="expand-all-btn" class="expand-all-btn" title="Expand or collapse all sections">Expand All</button>
    </div>
    <ul class="nav-list">
      <li><a href="#/" class="nav-link active" data-route="home">
        <span class="nav-icon">&#9670;</span> Home
      </a></li>
      <li class="nav-group" data-section="anti-aliasing">
        <button class="nav-section" aria-expanded="true">Anti-Aliasing</button>
        <ul class="nav-group-items">
          <li><a href="#/aa_demo" class="nav-link" data-route="aa_demo">
            <span class="nav-icon">&#9638;</span> AA Demo
          </a></li>
          <li><a href="#/rasterizers" class="nav-link" data-route="rasterizers">
            <span class="nav-icon">&#9651;</span> Rasterizers
          </a></li>
          <li><a href="#/rasterizers2" class="nav-link" data-route="rasterizers2">
            <span class="nav-icon">&#9651;</span> Rasterizers 2
          </a></li>
          <li><a href="#/gamma_correction" class="nav-link" data-route="gamma_correction">
            <span class="nav-icon">&#947;</span> Gamma
          </a></li>
          <li><a href="#/gamma_tuner" class="nav-link" data-route="gamma_tuner">
            <span class="nav-icon">&#947;</span> Gamma Tuner
          </a></li>
          <li><a href="#/aa_test" class="nav-link" data-route="aa_test">
            <span class="nav-icon">&#9646;</span> AA Test
          </a></li>
          <li><a href="#/gamma_ctrl" class="nav-link" data-route="gamma_ctrl">
            <span class="nav-icon">&#947;</span> Gamma Ctrl
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="rendering">
        <button class="nav-section" aria-expanded="false">Rendering</button>
        <ul class="nav-group-items">
          <li><a href="#/lion" class="nav-link" data-route="lion">
            <span class="nav-icon">&#129409;</span> Lion
          </a></li>
          <li><a href="#/lion_outline" class="nav-link" data-route="lion_outline">
            <span class="nav-icon">&#129409;</span> Lion Outline
          </a></li>
          <li><a href="#/perspective" class="nav-link" data-route="perspective">
            <span class="nav-icon">&#9670;</span> Perspective
          </a></li>
          <li><a href="#/circles" class="nav-link" data-route="circles">
            <span class="nav-icon">&#9679;</span> Circles
          </a></li>
          <li><a href="#/shapes" class="nav-link" data-route="shapes">
            <span class="nav-icon">&#9711;</span> Shapes
          </a></li>
          <li><a href="#/alpha_mask" class="nav-link" data-route="alpha_mask">
            <span class="nav-icon">&#9673;</span> Alpha Mask
          </a></li>
          <li><a href="#/alpha_gradient" class="nav-link" data-route="alpha_gradient">
            <span class="nav-icon">&#9698;</span> Alpha Gradient
          </a></li>
          <li><a href="#/alpha_mask2" class="nav-link" data-route="alpha_mask2">
            <span class="nav-icon">&#9673;</span> Alpha Mask 2
          </a></li>
          <li><a href="#/alpha_mask3" class="nav-link" data-route="alpha_mask3">
            <span class="nav-icon">&#9673;</span> Alpha Mask 3
          </a></li>
          <li><a href="#/multi_clip" class="nav-link" data-route="multi_clip">
            <span class="nav-icon">&#9634;</span> Multi Clip
          </a></li>
          <li><a href="#/simple_blur" class="nav-link" data-route="simple_blur">
            <span class="nav-icon">&#9684;</span> Simple Blur
          </a></li>
          <li><a href="#/blur" class="nav-link" data-route="blur">
            <span class="nav-icon">&#9684;</span> Blur
          </a></li>
          <li><a href="#/lion_lens" class="nav-link" data-route="lion_lens">
            <span class="nav-icon">&#128269;</span> Lion Lens
          </a></li>
          <li><a href="#/blend_color" class="nav-link" data-route="blend_color">
            <span class="nav-icon">&#9684;</span> Blend Color
          </a></li>
          <li><a href="#/component_rendering" class="nav-link" data-route="component_rendering">
            <span class="nav-icon">&#9673;</span> Component Rendering
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="gradients">
        <button class="nav-section" aria-expanded="false">Gradients</button>
        <ul class="nav-group-items">
          <li><a href="#/gradients" class="nav-link" data-route="gradients">
            <span class="nav-icon">&#9632;</span> Gradients
          </a></li>
          <li><a href="#/gouraud" class="nav-link" data-route="gouraud">
            <span class="nav-icon">&#9650;</span> Gouraud
          </a></li>
          <li><a href="#/gouraud_mesh" class="nav-link" data-route="gouraud_mesh">
            <span class="nav-icon">&#9650;</span> Gouraud Mesh
          </a></li>
          <li><a href="#/gradient_focal" class="nav-link" data-route="gradient_focal">
            <span class="nav-icon">&#9737;</span> Focal Gradient
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="paths-strokes">
        <button class="nav-section" aria-expanded="false">Paths &amp; Strokes</button>
        <ul class="nav-group-items">
          <li><a href="#/conv_stroke" class="nav-link" data-route="conv_stroke">
            <span class="nav-icon">&#9135;</span> Conv Stroke
          </a></li>
          <li><a href="#/conv_contour" class="nav-link" data-route="conv_contour">
            <span class="nav-icon">&#9674;</span> Conv Contour
          </a></li>
          <li><a href="#/conv_dash" class="nav-link" data-route="conv_dash">
            <span class="nav-icon">&#9473;</span> Conv Dash
          </a></li>
          <li><a href="#/line_thickness" class="nav-link" data-route="line_thickness">
            <span class="nav-icon">&#8212;</span> Line Thickness
          </a></li>
          <li><a href="#/conv_dash_marker" class="nav-link" data-route="conv_dash_marker">
            <span class="nav-icon">&#10230;</span> Dash Marker
          </a></li>
          <li><a href="#/line_patterns" class="nav-link" data-route="line_patterns">
            <span class="nav-icon">&#9473;</span> Line Patterns
          </a></li>
          <li><a href="#/line_patterns_clip" class="nav-link" data-route="line_patterns_clip">
            <span class="nav-icon">&#9634;</span> Line Patterns Clip
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="curves">
        <button class="nav-section" aria-expanded="false">Curves</button>
        <ul class="nav-group-items">
          <li><a href="#/bezier_div" class="nav-link" data-route="bezier_div">
            <span class="nav-icon">&#8765;</span> Bezier Div
          </a></li>
          <li><a href="#/bspline" class="nav-link" data-route="bspline">
            <span class="nav-icon">&#8765;</span> B-Spline
          </a></li>
          <li><a href="#/trans_curve1" class="nav-link" data-route="trans_curve1">
            <span class="nav-icon">&#8765;</span> Text on Curve 1
          </a></li>
          <li><a href="#/trans_curve2" class="nav-link" data-route="trans_curve2">
            <span class="nav-icon">&#8765;</span> Text on Curve 2
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="shapes">
        <button class="nav-section" aria-expanded="false">Shapes</button>
        <ul class="nav-group-items">
          <li><a href="#/rounded_rect" class="nav-link" data-route="rounded_rect">
            <span class="nav-icon">&#9645;</span> Rounded Rect
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="misc">
        <button class="nav-section" aria-expanded="false">Misc</button>
        <ul class="nav-group-items">
          <li><a href="#/idea" class="nav-link" data-route="idea">
            <span class="nav-icon">&#128161;</span> Idea
          </a></li>
          <li><a href="#/trans_polar" class="nav-link" data-route="trans_polar">
            <span class="nav-icon">&#9741;</span> Polar Transform
          </a></li>
          <li><a href="#/distortions" class="nav-link" data-route="distortions">
            <span class="nav-icon">&#9741;</span> Distortions
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="advanced">
        <button class="nav-section" aria-expanded="false">Advanced</button>
        <ul class="nav-group-items">
          <li><a href="#/graph_test" class="nav-link" data-route="graph_test">
            <span class="nav-icon">&#128200;</span> Graph Test
          </a></li>
          <li><a href="#/polymorphic_renderer" class="nav-link" data-route="polymorphic_renderer">
            <span class="nav-icon">&#9670;</span> Polymorphic Renderer
          </a></li>
          <li><a href="#/scanline_boolean" class="nav-link" data-route="scanline_boolean">
            <span class="nav-icon">&#8745;</span> Scanline Boolean
          </a></li>
          <li><a href="#/scanline_boolean2" class="nav-link" data-route="scanline_boolean2">
            <span class="nav-icon">&#8745;</span> Scanline Boolean 2
          </a></li>
          <li><a href="#/rasterizer_compound" class="nav-link" data-route="rasterizer_compound">
            <span class="nav-icon">&#9673;</span> Compound Rasterizer
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="compositing">
        <button class="nav-section" aria-expanded="false">Compositing</button>
        <ul class="nav-group-items">
          <li><a href="#/compositing" class="nav-link" data-route="compositing">
            <span class="nav-icon">&#9673;</span> Compositing
          </a></li>
          <li><a href="#/compositing2" class="nav-link" data-route="compositing2">
            <span class="nav-icon">&#9673;</span> Compositing 2
          </a></li>
          <li><a href="#/flash_rasterizer" class="nav-link" data-route="flash_rasterizer">
            <span class="nav-icon">&#9889;</span> Flash Rasterizer
          </a></li>
          <li><a href="#/flash_rasterizer2" class="nav-link" data-route="flash_rasterizer2">
            <span class="nav-icon">&#9889;</span> Flash Rasterizer 2
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="patterns">
        <button class="nav-section" aria-expanded="false">Patterns</button>
        <ul class="nav-group-items">
          <li><a href="#/pattern_fill" class="nav-link" data-route="pattern_fill">
            <span class="nav-icon">&#9638;</span> Pattern Fill
          </a></li>
          <li><a href="#/pattern_perspective" class="nav-link" data-route="pattern_perspective">
            <span class="nav-icon">&#9638;</span> Pattern Perspective
          </a></li>
          <li><a href="#/pattern_resample" class="nav-link" data-route="pattern_resample">
            <span class="nav-icon">&#9638;</span> Pattern Resample
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="text">
        <button class="nav-section" aria-expanded="false">Text</button>
        <ul class="nav-group-items">
          <li><a href="#/gsv_text" class="nav-link" data-route="gsv_text">
            <span class="nav-icon">A</span> GSV Text
          </a></li>
          <li><a href="#/raster_text" class="nav-link" data-route="raster_text">
            <span class="nav-icon">A</span> Raster Text
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="images-filters">
        <button class="nav-section" aria-expanded="false">Images &amp; Filters</button>
        <ul class="nav-group-items">
          <li><a href="#/image_fltr_graph" class="nav-link" data-route="image_fltr_graph">
            <span class="nav-icon">&#8767;</span> Filter Graph
          </a></li>
          <li><a href="#/image1" class="nav-link" data-route="image1">
            <span class="nav-icon">&#127912;</span> Image Transforms
          </a></li>
          <li><a href="#/image_filters" class="nav-link" data-route="image_filters">
            <span class="nav-icon">&#128247;</span> Image Filters
          </a></li>
          <li><a href="#/image_filters2" class="nav-link" data-route="image_filters2">
            <span class="nav-icon">&#128247;</span> Image Filters 2
          </a></li>
          <li><a href="#/image_perspective" class="nav-link" data-route="image_perspective">
            <span class="nav-icon">&#127912;</span> Image Perspective
          </a></li>
          <li><a href="#/image_alpha" class="nav-link" data-route="image_alpha">
            <span class="nav-icon">&#127912;</span> Image Alpha
          </a></li>
          <li><a href="#/image_transforms" class="nav-link" data-route="image_transforms">
            <span class="nav-icon">&#127912;</span> Image Transforms
          </a></li>
          <li><a href="#/image_resample" class="nav-link" data-route="image_resample">
            <span class="nav-icon">&#127912;</span> Image Resample
          </a></li>
        </ul>
      </li>
      <li class="nav-group" data-section="molecules">
        <button class="nav-section" aria-expanded="false">Molecules</button>
        <ul class="nav-group-items">
          <li><a href="#/mol_view" class="nav-link" data-route="mol_view">
            <span class="nav-icon">&#9883;</span> Mol Viewer
          </a></li>
        </ul>
      </li>
    </ul>
    <div class="sidebar-footer">
      <p><a href="https://github.com/larsbrubaker/agg-rust" target="_blank">Source on GitHub</a></p>
      <p>Rust port of <a href="http://www.antigrain.com" target="_blank">AGG 2.6</a></p>
      <p class="license">BSD-3-Clause License</p>
    </div>
  </nav>

  <main id="main-content">
    <!-- Content dynamically injected by router -->
  </main>

  <script>
    // Sidebar accordion — restore state from localStorage, default first section open
    (function() {
      var KEY = 'agg-sidebar-sections';
      var groups = document.querySelectorAll('.nav-group');
      var saved = null;
      try { saved = JSON.parse(localStorage.getItem(KEY)); } catch(e) {}

      groups.forEach(function(group, i) {
        var section = group.dataset.section;
        var btn = group.querySelector('.nav-section');
        var isOpen = saved ? !!saved[section] : i === 0;

        if (isOpen) {
          group.classList.add('open');
          btn.setAttribute('aria-expanded', 'true');
        } else {
          group.classList.remove('open');
          btn.setAttribute('aria-expanded', 'false');
        }

        btn.addEventListener('click', function() {
          var expanded = group.classList.toggle('open');
          btn.setAttribute('aria-expanded', String(expanded));
          saveState();
        });
      });

      function saveState() {
        var state = {};
        groups.forEach(function(g) {
          state[g.dataset.section] = g.classList.contains('open');
        });
        try { localStorage.setItem(KEY, JSON.stringify(state)); } catch(e) {}
      }

      // Expand All / Collapse All toggle
      var expandBtn = document.getElementById('expand-all-btn');
      function updateExpandBtnLabel() {
        var allOpen = true;
        groups.forEach(function(g) {
          if (!g.classList.contains('open')) allOpen = false;
        });
        expandBtn.textContent = allOpen ? 'Collapse All' : 'Expand All';
      }
      updateExpandBtnLabel();

      expandBtn.addEventListener('click', function() {
        var allOpen = true;
        groups.forEach(function(g) {
          if (!g.classList.contains('open')) allOpen = false;
        });
        var shouldOpen = !allOpen;
        groups.forEach(function(g) {
          var btn = g.querySelector('.nav-section');
          if (shouldOpen) {
            g.classList.add('open');
            btn.setAttribute('aria-expanded', 'true');
          } else {
            g.classList.remove('open');
            btn.setAttribute('aria-expanded', 'false');
          }
        });
        saveState();
        updateExpandBtnLabel();
      });

      // Update label when individual sections are toggled
      groups.forEach(function(group) {
        group.querySelector('.nav-section').addEventListener('click', function() {
          setTimeout(updateExpandBtnLabel, 0);
        });
      });
    })();
  </script>
  <script type="module" src="./public/dist/main.js"></script>
</body>
</html>
